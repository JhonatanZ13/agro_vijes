<div id="main" class="main">
    <div class="yd-cat">
        <div class="row mt-5">
            <div class="col-md-2 mt-3">
                <div class="container">
                    <div class="">
                        <div class="">
                            <div class="container">
                                <p>
                                <div class="cat2">
                                    <a data-toggle="collapse" href="#hortalizas" role="button" aria-expanded="false" aria-controls="hortalizas">
                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1)) ?>" class="text-dark"><h4>Todos los productos</h4></a>
                                    </a>
                                </div>
                                <hr>
                                </p>
                                <p>
                                <div class="cat2">
                                    <a data-toggle="collapse" href="#hortalizas" role="button" aria-expanded="false" aria-controls="hortalizas">
                                        <h4>Hortalizas</h4>
                                    </a>
                                </div>
                                </p>
                                <div class="collapse" id="hortalizas">
                                    <div class="card card-body">
                                        <div class="mt-2">
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 1)) ?>" class="text-dark">
                                                        <h3>Tomate</h3>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 2)) ?>" class="text-dark">
                                                        <h3>Cilantro</h3>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 3)) ?>" class="text-dark">
                                                        <h3>Pimenton</h3>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 4)) ?>" class="text-dark">
                                                        <h3>Habichuela</h3>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 5)) ?>" class="text-dark">
                                                        <h3>Cebolla larga</h3>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 6)) ?>" class="text-dark">
                                                        <h3>Pepino</h3>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 7)) ?>" class="text-dark hover_cards">
                                                        <h3>Aji</h3>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 8)) ?>" class="text-dark">
                                                        <h3>Zapallo</h3>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr>
                                <p>
                                <div class="cat2">
                                    <a data-toggle="collapse" href="#frutas" role="button" aria-expanded="false" aria-controls="frutas">
                                        <h4>Frutas</h4>
                                    </a>
                                </div>
                                </p>
                                <div class="collapse" id="frutas">
                                    <div class="card card-body">
                                        <div class="mt-2">
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 9)) ?>" class="text-dark">
                                                        <h3>Aguacate</h3>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 10)) ?>" class="text-dark">
                                                        <h3>Banano</h3>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 11)) ?>" class="text-dark">
                                                        <h3>Lulo</h3>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 12)) ?>" class="text-dark">
                                                        <h3>Mango</h3>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 13)) ?>" class="text-dark">
                                                        <h3>Maracuya</h3>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 14)) ?>" class="text-dark">
                                                        <h3>Piña</h3>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr>

                                <p>
                                <div class="cat2">
                                    <a data-toggle="collapse" href="#tuberculos" role="button" aria-expanded="false" aria-controls="tuberculos">
                                        <h4>Tubérculos</h4>
                                    </a>
                                </div>
                                </p>
                                <div class="collapse" id="tuberculos">
                                    <div class="card card-body">
                                        <div class="mt-2">
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 15)) ?>" class="text-dark">
                                                        <h3>Yuca</h3>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 16)) ?>" class="text-dark">
                                                        <h3>Arracacha</h3>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr>
                                <p>
                                <div class="cat2">
                                    <a data-toggle="collapse" href="#legum_cere" role="button" aria-expanded="false" aria-controls="legum_cere">
                                        <h4>Legumbres y cereales</h4>
                                    </a>
                                </div>
                                </p>
                                <div class="collapse" id="legum_cere">
                                    <div class="card card-body">
                                        <div class="mt-2">
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 17)) ?>" class="text-dark">
                                                        <h3>Frijol</h3>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 18)) ?>" class="text-dark">
                                                        <h3>Maiz</h3>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr>

                                <p>
                                <div class="cat2">
                                    <a data-toggle="collapse" href="#cafes" role="button" aria-expanded="false" aria-controls="cafes">
                                        <h4>Cafés</h4>
                                    </a>
                                </div>
                                </p>
                                <div class="collapse" id="cafes">
                                    <div class="card card-body">
                                        <div class="mt-2">
                                            <div class="mb-2">
                                                <div class="p-2 text-center hover_cards" style="border: 1px solid green; border-radius: 5px;">
                                                    <a href="<?= getUrl("Agro", "Agro", "getProductos", array('pagina' => 1, 'pro_id' => 19)) ?>" class="text-dark">
                                                        <h3>Cafes especiales (organico)</h3>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <br>
                                <br>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-8">
                <div class="container">
                    <div class="">
                        <div class="cat2">
                            <h2>Publicaciones recientes</h2>
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <?php

                        use Carbon\Carbon;

                        if (mysqli_num_rows($eje) > 0) {
                            $cont = 0;
                            foreach ($eje as $eje) {
                        ?>
                                <div class="col-md-4 mb-4">
                                    <div class="card h-100 shadow-sm" style="border: 2px solid green; overflow: hidden;">
                                        <div id="carousel<?= $cont ?>" class="carousel slide" style="height: 200px; overflow: hidden;" data-interval="false" data-ride="carousel">
                                            <ol class="carousel-indicators">
                                                <li data-target="#carousel<?= $cont ?>" data-slide-to="0" class="active"></li>
                                                <li data-target="#carousel<?= $cont ?>" data-slide-to="1"></li>
                                                <li data-target="#carousel<?= $cont ?>" data-slide-to="2"></li>
                                            </ol>
                                            <div class="carousel-inner">
                                                <div class="carousel-item active">
                                                    <img src="<?= $eje['foto1'] ?>" class="d-block w-100" alt="...">
                                                </div>
                                                <div class="carousel-item">
                                                    <img src="<?= $eje['foto2'] ?>" class="d-block w-100" alt="...">
                                                </div>
                                                <div class="carousel-item">
                                                    <img src="<?= $eje['foto3'] ?>" class="d-block w-100" alt="...">
                                                </div>
                                            </div>
                                            <a class="carousel-control-prev" href="#carousel<?= $cont ?>" role="button" data-slide="prev">
                                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                                <span class="sr-only">Previous</span>
                                            </a>
                                            <a class="carousel-control-next" href="#carousel<?= $cont ?>" role="button" data-slide="next">
                                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                                <span class="sr-only">Next</span>
                                            </a>
                                        </div>
                                        <div class="card-body bg-light">
                                            <div class="cat2">
                                                <h3 class="mt-2 font-weight-bold" style="font-size: 16pt;"><?= $eje['pro_titulo'] ?></h3>
                                            </div>
                                            <p style="font-size: 14pt; line-height: 20pt;">
                                                <strong style="font-weight: bold;">Vendedor:</strong> <?php echo $obj->Consultname2("CONCAT(usu_nombres,' ',usu_apellidos) as nombres", 'usuario WHERE usu_id = ' . $eje['pro_vendedor']) ?><br>
                                                <strong style="font-weight: bold;">Ubicacion: </strong><?php echo $obj->Consultname('ciu_nombre', 'ciudad WHERE ciu_id = ' . $eje['pro_ubicacion']) ?><br>
                                                <strong style="font-weight: bold;">Precio: $</strong><?= $eje['precio'] ?> <?php echo $obj->Consultname('nombre_tipo_med', 'tipo_medida WHERE id_tipo_medida  = ' . $eje['medida_peso']) ?> <br>
                                                <strong style="font-weight: bold;">Cantidad disponible: </strong><?= $eje['cantidad_disponible'] ?> <?php echo $obj->Consultname('abr_nombre', 'tipo_medida WHERE id_tipo_medida  = ' . $eje['medida_peso']) ?> <br>
                                            </p>
                                            <div class="row">
                                                <div class="col-md-6 mt-2">
                                                    <a href="https://wa.me/<?= $obj->ConsultTel($eje['usu_id']) ?>?" target="_blank"><button class="btn btn-green w-100">
                                                            <h3>Contactar <i class="fab fa-whatsapp"></i></h3>
                                                        </button></a>
                                                </div>
                                                <div class="col-md-6 mt-2">
                                                    <button type="button" class="btn btn-info w-100" id="modalBoton" data-id="<?= $eje['pro_id'] ?>">
                                                        <h3>Informacion <i class="fas fa-info-circle"></h3></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card-footer text-muted">
                                            <?php
                                            $fecha = new Carbon($eje['pro_fecha']);
                                            echo  $fecha->diffForHumans() ?>
                                        </div>
                                    </div>
                                </div>
                        <?php
                                $cont++;
                            }
                        } else {
                            echo "<div style='height: 60vh;' class='text-center w-100'>No se encontro ningun producto productos</div>";
                        }
                        ?>
                    </div>
                    <nav aria-label="Page navigation example">
                        <ul class="pagination justify-content-center">
                            <?php if (!isset($_GET['pro_id'])) { ?>
                                <li class="page-item <?php echo $_GET['pagina'] <= 1 ? 'disabled' : '' ?>">
                                    <a class="page-link" href="<?php echo getUrl("Agro", "Agro", "getProductos", array('pagina' => $_GET['pagina'] - 1)); ?>">Anterior</a>
                                </li>
                                <?php for ($i = 0; $i < $paginas; $i++) {

                                ?>
                                    <li class="page-item <?php echo $_GET['pagina'] == $i + 1 ? 'active' : '' ?>"><a class="page-link" href="<?php echo getUrl("Agro", "Agro", "getProductos", array('pagina' => $i + 1)); ?>"><?= $i + 1 ?></a></li>
                                <?php
                                }
                                ?>
                                <li class="page-item <?php echo $_GET['pagina'] >= $paginas ? 'disabled' : '' ?>">
                                    <a class="page-link" href="<?php echo getUrl("Agro", "Agro", "getProductos", array('pagina' => $_GET['pagina'] + 1)); ?>">Siguiente</a>
                                </li>
                            <?php } else { ?>
                                <li class="page-item <?php echo $_GET['pagina'] <= 1 ? 'disabled' : '' ?>">
                                    <a class="page-link" href="<?php echo getUrl("Agro", "Agro", "getProductos", array('pagina' => $_GET['pagina'] - 1, 'pro_id' => $_GET['pro_id'])); ?>">Anterior</a>
                                </li>
                                <?php for ($i = 0; $i < $paginas; $i++) {

                                ?>
                                    <li class="page-item <?php echo $_GET['pagina'] == $i + 1 ? 'active' : '' ?>"><a class="page-link" href="<?php echo getUrl("Agro", "Agro", "getProductos", array('pagina' => $i + 1, 'pro_id' => $_GET['pro_id'])); ?>"><?= $i + 1 ?></a></li>
                                <?php
                                }
                                ?>
                                <li class="page-item <?php echo $_GET['pagina'] >= $paginas ? 'disabled' : '' ?>">
                                    <a class="page-link" href="<?php echo getUrl("Agro", "Agro", "getProductos", array('pagina' => $_GET['pagina'] + 1, 'pro_id' => $_GET['pro_id'])); ?>">Siguiente</a>
                                </li>
                            <?php } ?>
                        </ul>
                    </nav>

                    <?php
                    if (isset($_SESSION['rol'])) {
                        if ($_SESSION['rol'] == 1 || $_SESSION['rol'] == 2 || $_SESSION['rol'] == 4) {
                    ?>
                            <div class="col-md-2" style="z-index: 1000;">
                                <a href="<?php echo getUrl("Agro", "Agro", "publicarProducto"); ?>" class="btn-flotante">Publicar producto</a>
                            </div>
                    <?php
                        }
                    }
                    ?>
                </div>
            </div>

        </div>
    </div>
</div>

<?php include_once "../view/partials/footer.php"; ?>